<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Piano Virtual - Rhay</title>
<style>
  body {
    background: #222;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem;
  }

  h1 {
    margin-bottom: 1rem;
  }

  .piano {
    display: flex;
    position: relative;
    user-select: none;
  }

  .key {
    border: 1px solid #333;
    border-radius: 0 0 6px 6px;
    height: 160px;
    width: 40px;
    margin: 0 1px;
    background: white;
    box-shadow: 0 4px 8px #0003 inset;
    cursor: pointer;
    position: relative;
    z-index: 1;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    font-size: 12px;
    color: #333;
  }

  .key.black {
    background: black;
    height: 100px;
    width: 28px;
    margin: 0 -14px 0 -14px;
    z-index: 2;
    border-radius: 0 0 4px 4px;
    color: #eee;
  }

  .key.pressed {
    background: #7fdbff;
    box-shadow: 0 0 15px #7fdbff;
  }

  .explanation {
    margin-top: 2rem;
    max-width: 600px;
    text-align: center;
    line-height: 1.5;
    font-size: 1rem;
    background: rgba(255 255 255 / 0.1);
    padding: 1rem 2rem;
    border-radius: 12px;
    user-select: text;
  }
</style>
</head>
<body>
  <h1>Piano Virtual - Rhay</h1>

  <div class="piano" id="piano">
    <!-- Teclas brancas -->
    <div class="key white" data-note="C4">C</div>
    <div class="key black" data-note="C#4" style="left: 28px; position: absolute; margin: 0;"></div>
    <div class="key white" data-note="D4">D</div>
    <div class="key black" data-note="D#4" style="left: 68px; position: absolute; margin: 0;"></div>
    <div class="key white" data-note="E4">E</div>
    <div class="key white" data-note="F4">F</div>
    <div class="key black" data-note="F#4" style="left: 148px; position: absolute; margin: 0;"></div>
    <div class="key white" data-note="G4">G</div>
    <div class="key black" data-note="G#4" style="left: 188px; position: absolute; margin: 0;"></div>
    <div class="key white" data-note="A4">A</div>
    <div class="key black" data-note="A#4" style="left: 228px; position: absolute; margin: 0;"></div>
    <div class="key white" data-note="B4">B</div>
  </div>

  <div class="explanation">
    <p>Toque as teclas clicando nelas ou usando o teclado do seu computador:</p>
    <p><strong>Teclas do teclado:</strong> Z=C4, S=C#4, X=D4, D=D#4, C=E4, V=F4, G=F#4, B=G4, H=G#4, N=A4, J=A#4, M=B4</p>
  </div>

<script>
  // Mapear teclas do teclado para notas
  const keyMap = {
    'z': 'C4',
    's': 'C#4',
    'x': 'D4',
    'd': 'D#4',
    'c': 'E4',
    'v': 'F4',
    'g': 'F#4',
    'b': 'G4',
    'h': 'G#4',
    'n': 'A4',
    'j': 'A#4',
    'm': 'B4'
  };

  // Frequências das notas (temperamento igual)
  const frequencies = {
    'C4': 261.63,
    'C#4': 277.18,
    'D4': 293.66,
    'D#4': 311.13,
    'E4': 329.63,
    'F4': 349.23,
    'F#4': 369.99,
    'G4': 392.00,
    'G#4': 415.30,
    'A4': 440.00,
    'A#4': 466.16,
    'B4': 493.88,
  };

  // Criar contexto de áudio
  const AudioContext = window.AudioContext || window.webkitAudioContext;
  const audioCtx = new AudioContext();

  function playNote(freq) {
    const oscillator = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    oscillator.type = 'sine';
    oscillator.frequency.setValueAtTime(freq, audioCtx.currentTime);
    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);

    oscillator.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    oscillator.start();
    oscillator.stop(audioCtx.currentTime + 0.5);
  }

  // Tocar nota por nome
  function tocarNota(nome) {
    if (!frequencies[nome]) return;
    playNote(frequencies[nome]);
    const keyEl = [...document.querySelectorAll('.key')].find(k => k.dataset.note === nome);
    if (keyEl) {
      keyEl.classList.add('pressed');
      setTimeout(() => keyEl.classList.remove('pressed'), 150);
    }
  }

  // Clique nas teclas
  document.getElementById('piano').addEventListener('mousedown', e => {
    if (e.target.classList.contains('key')) {
      tocarNota(e.target.dataset.note);
    }
  });

  // Usar teclado do PC
  window.addEventListener('keydown', e => {
    if (e.repeat) return; // evita repetir nota segurando tecla
    const note = keyMap[e.key.toLowerCase()];
    if (note) {
      tocarNota(note);
    }
  });
</script>
</body>
</html>
